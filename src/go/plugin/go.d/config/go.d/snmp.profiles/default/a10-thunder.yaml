extends:
  - a10.yaml

sysobjectid: 1.3.6.1.4.1.22610.1.3.* # A10 Thunder

metadata:
  device:
    fields:
      type:
        value: "ADC"

metrics:
  - MIB: A10-AX-MIB
    symbol:
      name: memory.total
      OID: 1.3.6.1.4.1.22610.2.4.1.2.1.0
      description: The total memory
      family: Memory/Total
      unit: "kBy"
  - MIB: A10-AX-MIB
    symbol:
      name: memory.used
      OID: 1.3.6.1.4.1.22610.2.4.1.2.2.0
      description: The usage memory
      family: Memory/Used
      unit: "kBy"
  - MIB: A10-AX-MIB
    symbol:
      name: cpu.usage
      OID: 1.3.6.1.4.1.22610.2.4.1.3.3.0
      description: The average CPU usage in last 5 seconds
      family: CPU/Usage
      unit: "%"
  - MIB: A10-AX-MIB
    symbol:
      name: axSysDiskTotalSpace
      OID: 1.3.6.1.4.1.22610.2.4.1.4.1.0
      description: The total space of the disk
      family: Disk/Size
      unit: "MBy"
  - MIB: A10-AX-MIB
    symbol:
      name: axSysDiskFreeSpace
      OID: 1.3.6.1.4.1.22610.2.4.1.4.2.0
      description: The free space of the disk
      family: Disk/Free
      unit: "MBy"
  - MIB: A10-AX-MIB
    symbol:
      name: axSysHwPhySystemTemp
      OID: 1.3.6.1.4.1.22610.2.4.1.5.1.0
      description: The physical system temperature in Celsius
      family: System/Temperature
      unit: "Cel"
  # - MIB: A10-AX-MIB
  #   symbol:
  #     name: axPowerSupplyVoltageTotal
  #     OID: 1.3.6.1.4.1.22610.2.4.1.5.10.0
  #     description: TBD
  #     unit: "TBD"
  # TODO can't find details
  - MIB: A10-AX-MIB
    symbol:
      name: axAppGlobalTotalCurrentConnections
      OID: 1.3.6.1.4.1.22610.2.4.3.1.2.1.0
      description: Total current connections
      family: Application/Connections/Total/Current
      unit: "{connection}/s"
  - MIB: A10-AX-MIB
    symbol:
      name: axAppGlobalTotalNewConnections
      OID: 1.3.6.1.4.1.22610.2.4.3.1.2.2.0
      metric_type: monotonic_count
      description: Total new connections
      family: Application/Connections/Total/New
      unit: "{connection}/s"
  - MIB: A10-AX-MIB
    symbol:
      name: axAppGlobalTotalNewL4Connections
      OID: 1.3.6.1.4.1.22610.2.4.3.1.2.3.0
      metric_type: monotonic_count
      description: Total new L4 connections
      family: Application/Connections/L4/New
      unit: "{connection}/s"
  - MIB: A10-AX-MIB
    symbol:
      name: axAppGlobalTotalNewL7Connections
      OID: 1.3.6.1.4.1.22610.2.4.3.1.2.4.0
      metric_type: monotonic_count
      description: Total new L7 connections
      family: Application/Connections/L7/New
      unit: "{connection}/s"
  - MIB: A10-AX-MIB
    symbol:
      name: axAppGlobalTotalNewIPNatConnections
      OID: 1.3.6.1.4.1.22610.2.4.3.1.2.5.0
      metric_type: monotonic_count
      description: Total new IP-NAT connections
      family: Application/Connections/IP-NAT/New
      unit: "{connection}/s"
  - MIB: A10-AX-MIB
    symbol:
      name: axAppGlobalTotalSSLConnections
      OID: 1.3.6.1.4.1.22610.2.4.3.1.2.6.0
      metric_type: monotonic_count
      description: Total new SSL connections
      family: Application/Connections/SSL/New
      unit: "{connection}/s"
  - MIB: A10-AX-MIB
    symbol:
      name: axAppGlobalTotalL7Requests
      OID: 1.3.6.1.4.1.22610.2.4.3.1.2.7.0
      metric_type: monotonic_count
      description: Total L7 requests
      family: Application/Requests/L7/Total
      unit: "{request}/s"
  - MIB: A10-AX-MIB
    symbol:
      name: axGlobalAppPacketDrop
      OID: 1.3.6.1.4.1.22610.2.4.3.1.2.8.0
      description: Total number of buffer drops in the last 10 seconds
      family: Application/Packets
      unit: "{drop}/s"
  - MIB: A10-AX-MIB
    symbol:
      name: axGlobalTotalAppPacketDrop
      OID: 1.3.6.1.4.1.22610.2.4.3.1.2.9.0
      description: Total number of accumulative buffer drops
      family: Application/Packets
      unit: "{packet}/s"
  - MIB: A10-AX-MIB
    symbol:
      name: axGlobalTotalL4Session
      OID: 1.3.6.1.4.1.22610.2.4.3.1.2.10.0
      description: Total number of L4 sessions
      family: Sessions/L4
      unit: "{session}/s"
  # - MIB: A10-AX-MIB
  #   symbol:
  #     name: axGlobalTotalThroughput
  #     OID: 1.3.6.1.4.1.22610.2.4.3.1.2.13.0
  #     description: TBD
  #     unit: "TBD"
  # TODO can't find details
  - MIB: A10-AX-MIB
    symbol:
      name: axAppGlobalBufferConfigLimit
      OID: 1.3.6.1.4.1.22610.2.4.3.1.3.1.0
      description: Application buffer configured limit
      family: Application/Buffer/Limit
      unit: "1"
      # TODO no info if this is in bytes
  - MIB: A10-AX-MIB
    symbol:
      name: axAppGlobalBufferCurrentUsage
      OID: 1.3.6.1.4.1.22610.2.4.3.1.3.2.0
      description: Application buffer current usage
      family: Application/Buffer/Usage
      unit: "1"
      # TODO no info if this is in bytes
  - MIB: A10-AX-MIB
    symbol:
      name: axConnReuseStatTotalOpenPersist
      OID: 1.3.6.1.4.1.22610.2.4.3.5.1.0
      description: The total count of open persistent connection-reuse sessions
      family: Sessions/Connection-Reuse/Open
      unit: "{session}/s"
  - MIB: A10-AX-MIB
    symbol:
      name: axConnReuseStatTotalActivePersist
      OID: 1.3.6.1.4.1.22610.2.4.3.5.2.0
      description: The total count of active persistent connection-reuse sessions
      family: Sessions/Connection-Reuse/Active
      unit: "{session}/s"
  - MIB: A10-AX-MIB
    symbol:
      name: axConnReuseStatTotalEstablished
      OID: 1.3.6.1.4.1.22610.2.4.3.5.3.0
      description: The total count of established connection-reuse sessions
      family: Sessions/Connection-Reuse/Established
      unit: "{session}/s"
  - MIB: A10-AX-MIB
    symbol:
      name: axConnReuseStatTotalTerminated
      OID: 1.3.6.1.4.1.22610.2.4.3.5.4.0
      description: The total count of terminated connection-reuse sessions
      family: Sessions/Connection-Reuse/Terminated
      unit: "{session}/s"
  - MIB: A10-AX-MIB
    symbol:
      name: axSessionGlobalStatTCPEstablished
      OID: 1.3.6.1.4.1.22610.2.4.3.19.1.1.0
      description: The count of TCP established
      family: Connections/TCP/Established
      unit: "{connection}"
  - MIB: A10-AX-MIB
    symbol:
      name: axSessionGlobalStatTCPHalfOpen
      OID: 1.3.6.1.4.1.22610.2.4.3.19.1.2.0
      description: The count of TCP half open
      family: Connections/TCP/Half Open
      unit: "{connection}"
  - MIB: A10-AX-MIB
    symbol:
      name: axSessionGlobalStatUDP
      OID: 1.3.6.1.4.1.22610.2.4.3.19.1.3.0
      description: The count of UDP connections
      family: Connections/UDP/Established
      unit: "{connection}"
  - MIB: A10-AX-MIB
    symbol:
      name: axSessionGlobalStatNonTcpUdpIPSession
      OID: 1.3.6.1.4.1.22610.2.4.3.19.1.4.0
      description: The count of non TCP/UDP IP sessions
      family: Sessions/TODO
      # What family to use here?
      unit: "{session}"
  - MIB: A10-AX-MIB
    symbol:
      name: axSessionGlobalStatOther
      OID: 1.3.6.1.4.1.22610.2.4.3.19.1.5.0
      description: The count of others
      family: Sessions/Other
      unit: "{session}"
  - MIB: A10-AX-MIB
    symbol:
      name: axSessionGlobalStatReverseNATTCP
      OID: 1.3.6.1.4.1.22610.2.4.3.19.1.6.0
      description: The count of reverse NAT TCP
      family: Connections/Reverse NAT TCP
      unit: "{connection}"
  - MIB: A10-AX-MIB
    symbol:
      name: axSessionGlobalStatReverseNATUDP
      OID: 1.3.6.1.4.1.22610.2.4.3.19.1.7.0
      description: The count of reverse NAT UDP
      family: Connections/Reverse NAT UDP
      unit: "{connection}"
  - MIB: A10-AX-MIB
    symbol:
      name: axSessionGlobalStatFreeCurrentConns
      OID: 1.3.6.1.4.1.22610.2.4.3.19.1.9.0
      description: The count of free current connections
      family: Connections/Free
      unit: "{connection}"
  - MIB: A10-AX-MIB
    symbol:
      name: axSessionGlobalStatConnCount
      OID: 1.3.6.1.4.1.22610.2.4.3.19.1.10.0
      description: The count of current connections
      family: Connections/Current
      unit: "{connection}"
  - MIB: A10-AX-MIB
    symbol:
      name: axSessionGlobalStatConnFree
      OID: 1.3.6.1.4.1.22610.2.4.3.19.1.11.0
      description: The count of freed connections
      unit: "{connection}"
      family: Connections/Freed
  - MIB: A10-AX-MIB
    symbol:
      name: axSessionGlobalStatTCPSynHalfOpen
      OID: 1.3.6.1.4.1.22610.2.4.3.19.1.12.0
      description: The count of TCP SYN half open
      family: Connections/TCP SYN half open
      unit: "{connection}"
  - MIB: A10-AX-MIB
    symbol:
      name: axSessionGlobalStatConnSMPAllocated
      OID: 1.3.6.1.4.1.22610.2.4.3.19.1.13.0
      description: The count of allocated SMP connections
      family: Connections/SMP/Allocated
      unit: "{connection}"
  - MIB: A10-AX-MIB
    symbol:
      name: axSessionGlobalStatConnSMPFree
      OID: 1.3.6.1.4.1.22610.2.4.3.19.1.14.0
      description: The count of free SMP connections
      family: Connections/SMP/Free
      unit: "{connection}"
  - MIB: A10-AX-MIB
    table:
      name: axSysFanStatusTable
      OID: 1.3.6.1.4.1.22610.2.4.1.5.9
    symbols:
      - name: axFanSpeed
        OID: 1.3.6.1.4.1.22610.2.4.1.5.9.1.4
        description: The fan1's speed
        family: Fans/Speed
        unit: "{rotation}/min"
      - symbol:
        OID: 1.3.6.1.4.1.22610.2.4.1.5.9.1.3
        name: axFanStatus
        description: Fan status
        family: Fans/Status
        unit: "{status}"
        mapping:
          0: failed
          4: ok_fixed_high
          5: ok_low_med
          6: ok_med_med
          7: ok_med_high
          -2: not_ready
          -1: unknown
    metric_tags:
      - symbol:
          name: axFanName
          OID: 1.3.6.1.4.1.22610.2.4.1.5.9.1.2
        tag: ax_fan_name

  - MIB: A10-AX-MIB
    table:
      name: axPowerSupplyVoltageTable
      OID: 1.3.6.1.4.1.22610.2.4.1.5.11
    symbols:
      - OID: 1.3.6.1.4.1.22610.2.4.1.5.11.1.2
        name: axPowerSupplyVoltageStatus
        description: Power Supply voltage status
        unit: "{status}"
        mapping:
          0: invalid
          1: normal
          2: unknown
    metric_tags:
      - symbol:
          name: axPowerSupplyVoltageDescription
          OID: 1.3.6.1.4.1.22610.2.4.1.5.11.1.3
        tag: ax_power_supply_voltage_description

  - MIB: A10-AX-MIB
    table:
      name: axSysPowerSupplyStatusTable
      OID: 1.3.6.1.4.1.22610.2.4.1.5.12
    symbols:
      - OID: 1.3.6.1.4.1.22610.2.4.1.5.12.1.3
        name: axPowerSupplyStatus
        description: Power Supply status
        unit: "{status}"
        mapping:
          0: off
          1: on
          2: absent
          -1: unknown
    metric_tags:
      - symbol:
          name: axPowerSupplyName
          OID: 1.3.6.1.4.1.22610.2.4.1.5.12.1.2
        tag: ax_power_supply_name

  # - MIB: A10-AX-MIB
  #   table:
  #     name: axAppGlobalSystemResourceUsageTable
  #     OID: 1.3.6.1.4.1.22610.2.4.3.1.1.1
  #   symbols:
  #     - name: axAppGlobalAllowedCurrentValue
  #       OID: 1.3.6.1.4.1.22610.2.4.3.1.1.1.1.3
  #       description: The current value for the allowed system resource
  #       unit: "{resource}"
  #     - name: axAppGlobalAllowedMaxValue
  #       OID: 1.3.6.1.4.1.22610.2.4.3.1.1.1.1.6
  #       description: The maximum value for the allowed system resource
  #       unit: "{resource}"
  #   metric_tags:
  #     - symbol:
  #         name: axAppGlobalSystemResourceName
  #         OID: 1.3.6.1.4.1.22610.2.4.3.1.1.1.1.2
  #       tag: ax_app_global_system_resource_name
  # TODO dynamic metric names from the provided name (axAppGlobalSystemResourceName).
  - MIB: A10-AX-MIB
    table:
      name: axServerTable
      OID: 1.3.6.1.4.1.22610.2.4.3.2.1.2
    symbols:
      - OID: 1.3.6.1.4.1.22610.2.4.3.2.1.2.1.3
        name: axServerEnabledState
        description: The monitor state for this node address
        unit: "{status}"
        mapping:
          0: disabled
          1: enabled
      - OID: 1.3.6.1.4.1.22610.2.4.3.2.1.2.1.5
        name: axServerMonitorState
        description: The server monitor status
        unit: "{status}"
        mapping:
          0: disabled
          1: up
          2: down
    metric_tags:
      - symbol:
          name: axServerName
          OID: 1.3.6.1.4.1.22610.2.4.3.2.1.2.1.1
        tag: ax_server_name

  - MIB: A10-AX-MIB
    table:
      name: axServerStatTable
      OID: 1.3.6.1.4.1.22610.2.4.3.2.2.2
    symbols:
      - name: axServerStatServerCurConns
        OID: 1.3.6.1.4.1.22610.2.4.3.2.2.2.1.8
        description: The current connections from server side
        family: Servers/Connections/Current
        unit: "{connection}"
      - name: axServerStatServerTotalCurrL7Reqs
        OID: 1.3.6.1.4.1.22610.2.4.3.2.2.2.1.12
        metric_type: monotonic_count
        description: The number of current L7 requests if applicable
        family: Servers/Requests/L7
        unit: "{request}"
      - OID: 1.3.6.1.4.1.22610.2.4.3.2.2.2.1.10
        name: axServerStatServerStatus
        description: Server status
        family: Servers/Status
        unit: "{status}"
        mapping:
          0: disabled
          1: up
          2: down
    metric_tags:
      - symbol:
          name: axServerStatName
          OID: 1.3.6.1.4.1.22610.2.4.3.2.2.2.1.2
        tag: ax_server_stat_name

  - MIB: A10-AX-MIB
    table:
      name: axServiceGroupTable
      OID: 1.3.6.1.4.1.22610.2.4.3.3.1.2
    symbols:
      - name: axServiceGroup
        constant_value_one: true
        description: TBD
        unit: "TBD"
      - OID: 1.3.6.1.4.1.22610.2.4.3.3.1.2.1.4
        name: axServiceGroupDisplayStatus
        description: Service group status
        family: Service Groups/Status
        unit: "{status}"
        mapping:
          1: all_up
          2: functional_up
          3: partial_up
          4: stopped
    metric_tags:
      - symbol:
          name: axServiceGroupName
          OID: 1.3.6.1.4.1.22610.2.4.3.3.1.2.1.1
        tag: ax_service_group_name
      - symbol:
          name: axServiceGroupType
          OID: 1.3.6.1.4.1.22610.2.4.3.3.1.2.1.2
        tag: ax_service_group_type
        mapping:
          1: firewall
          2: tcp
          3: udp
      - symbol:
          name: axServiceGroupLbAlgorithm
          OID: 1.3.6.1.4.1.22610.2.4.3.3.1.2.1.3
        tag: ax_service_group_lb_algorithm
        mapping:
          0: round_robin
          1: weight_round_robin
          2: least_connection
          3: weight_least_connection
          4: service_least_connection
          5: service_weight_least_connection
          6: fast_response_time
          7: least_request
          8: round_robin_strict

  - MIB: A10-AX-MIB
    table:
      name: axVirtualServerTable
      OID: 1.3.6.1.4.1.22610.2.4.3.4.1.2
    symbols:
      - OID: 1.3.6.1.4.1.22610.2.4.3.4.1.2.1.5
        name: axVirtualServerDisplayStatus
        description: Display status of the virtual server
        family: Virtual Servers/Status
        unit: "{status}"
        mapping:
          0: disabled
          1: all_up
          2: functional_up
          3: partial_up
          4: stopped
    metric_tags:
      - symbol:
          name: axVirtualServerName
          OID: 1.3.6.1.4.1.22610.2.4.3.4.1.2.1.1
        tag: ax_virtual_server_name
      - symbol:
          name: axVirtualServerHAGroup
          OID: 1.3.6.1.4.1.22610.2.4.3.4.1.2.1.4
        tag: ax_virtual_server_ha_group
      - symbol:
          OID: 1.3.6.1.4.1.22610.2.4.3.4.1.2.1.3
          name: axVirtualServerEnabled
        tag: ax_virtual_server_enabled
        mapping:
          0: disabled
          1: enabled

  - MIB: A10-AX-MIB
    table:
      name: axVirtualServerStatTable
      OID: 1.3.6.1.4.1.22610.2.4.3.4.2.1
    symbols:
      - name: axVirtualServerStatPktsIn
        OID: 1.3.6.1.4.1.22610.2.4.3.4.2.1.1.3
        metric_type: monotonic_count
        description: The number of packets received from client to server
        family: Virtual Servers/Packets
        unit: "{packet}/s"
      - name: axVirtualServerStatBytesIn
        OID: 1.3.6.1.4.1.22610.2.4.3.4.2.1.1.4
        metric_type: monotonic_count
        description: The number of bytes received from client to server
        family: Virtual Servers/Traffic
        unit: "By/s"
      - name: axVirtualServerStatPktsOut
        OID: 1.3.6.1.4.1.22610.2.4.3.4.2.1.1.5
        metric_type: monotonic_count
        description: The number of packets sent from server to client
        family: Virtual Servers/Packets
        unit: "{packet}/s"
      - name: axVirtualServerStatBytesOut
        OID: 1.3.6.1.4.1.22610.2.4.3.4.2.1.1.6
        metric_type: monotonic_count
        description: The number of bytes sent from server to client
        family: Virtual Servers/Traffic
        unit: "By/s"
      - name: axVirtualServerStatPersistConns
        OID: 1.3.6.1.4.1.22610.2.4.3.4.2.1.1.7
        description: The persistent connections from client side
        unit: "{connection}/s"
        family: Virtual Servers/Connections/Persistent
      - name: axVirtualServerStatTotConns
        OID: 1.3.6.1.4.1.22610.2.4.3.4.2.1.1.8
        metric_type: monotonic_count
        description: The total connections from client side
        family: Virtual Servers/Connections/Total
        unit: "{connection}/s"
      - name: axVirtualServerStatCurConns
        OID: 1.3.6.1.4.1.22610.2.4.3.4.2.1.1.9
        description: The current connections from client side
        family: Virtual Servers/Connections/Current
        unit: "{connection}"
      - name: axVirtualServerStatTotalL7Reqs
        OID: 1.3.6.1.4.1.22610.2.4.3.4.2.1.1.12
        metric_type: monotonic_count
        description: The total number of L7 requests if applicable
        family: Virtual Servers/Requests/L7
        unit: "{request}/s"
      - name: axVirtualServerStatTotalCurrL7Reqs
        OID: 1.3.6.1.4.1.22610.2.4.3.4.2.1.1.13
        metric_type: monotonic_count
        description: The number of current L7 requests if applicable
        family: Virtual Servers/Requests/L7
        unit: "{request}/s"
      - name: axVirtualServerStatTotalSuccL7Reqs
        OID: 1.3.6.1.4.1.22610.2.4.3.4.2.1.1.14
        metric_type: monotonic_count
        description: The number of successful L7 requests if applicable
        family: Virtual Servers/Requests/L7
        unit: "{request}/s"
      - OID: 1.3.6.1.4.1.22610.2.4.3.4.2.1.1.10
        name: axVirtualServerStatStatus
        description: Virtual server status
        family: Virtual Servers/Status
        mapping:
          1: up
          2: down
          3: disabled
    metric_tags:
      - symbol:
          name: axVirtualServerStatAddress
          OID: 1.3.6.1.4.1.22610.2.4.3.4.2.1.1.1
        tag: ax_virtual_server_stat_address
      - symbol:
          name: axVirtualServerStatName
          OID: 1.3.6.1.4.1.22610.2.4.3.4.2.1.1.2
        tag: ax_virtual_server_stat_name

  - MIB: A10-AX-MIB
    table:
      name: axVirtualServerPortStatTable
      OID: 1.3.6.1.4.1.22610.2.4.3.4.4.1
    symbols:
      - name: axVirtualServerPortStatCurConns
        OID: 1.3.6.1.4.1.22610.2.4.3.4.4.1.1.12
        description: Current connections from client side
        family: Virtual Servers/Service Ports/Connections/Clients
        unit: "{connection}"
      - OID: 1.3.6.1.4.1.22610.2.4.3.4.4.1.1.13
        name: axVirtualServerStatPortDisplayStatus
        description: Virtual server port display status
        family: Virtual Servers/Service Ports/Status
        unit: "{status}"
        mapping:
          0: disabled
          1: all_up
          2: functional_up
          4: stopped
      - symbol:
        OID: 1.3.6.1.4.1.22610.2.4.3.4.4.1.1.5
        name: axVirtualServerStatPortStatus
        description: Virtual server port status
        family: Virtual Servers/Service Ports/Status
        unit: "{status}"
        mapping:
          1: up
          2: down
          3: disabled
    metric_tags:
      - symbol:
          name: axVirtualServerPortStatAddress
          OID: 1.3.6.1.4.1.22610.2.4.3.4.4.1.1.1
        tag: ax_virtual_server_port_stat_address
      - symbol:
          name: axVirtualServerStatPortType
          OID: 1.3.6.1.4.1.22610.2.4.3.4.4.1.1.2
        tag: ax_virtual_server_stat_port_type
        mapping:
          1: firewall
          2: tcp
          3: udp
          8: rtsp
          9: ftp
          10: mms
          12: fast_http
          14: http
          15: https
          16: ssl_proxy
          17: smtp
          11: sip
          19: sips
          18: sip_tcp
          5: others
      - symbol:
          name: axVirtualServerStatPortNum
          OID: 1.3.6.1.4.1.22610.2.4.3.4.4.1.1.3
        tag: ax_virtual_server_stat_port_num
      - symbol:
          name: axVirtualServerPortStatName
          OID: 1.3.6.1.4.1.22610.2.4.3.4.4.1.1.4
        tag: ax_virtual_server_port_stat_name

metric_tags:
  - OID: 1.3.6.1.4.1.22610.2.4.1.6.2.0
    symbol: axSysSerialNumber
    tag: ax_sys_serial_number
  - OID: 1.3.6.1.4.1.22610.2.4.1.6.3.0
    symbol: axSysFirmwareVersion
    tag: ax_sys_firmware_version
  - OID: 1.3.6.1.4.1.22610.2.4.1.6.4.0
    symbol: axSysAFleXEngineVersion
    tag: ax_sys_a_fle_x_engine_version
