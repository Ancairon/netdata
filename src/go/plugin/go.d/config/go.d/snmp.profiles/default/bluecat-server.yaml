extends:
  - _base.yaml
  - _generic-if.yaml
  - _generic-host-resources-base.yaml
  - _generic-ucd.yaml

metadata:
  device:
    fields:
      vendor:
        value: Bluecat
      type:
        value: Server

sysobjectid:
  - 1.3.6.1.4.1.13315.2.*

metrics:
  - MIB: BCN-DHCPV4-MIB
    table:
      OID: 1.3.6.1.4.1.13315.3.1.1.2.2.2
      name: bcnDhcpv4SubnetTable
    symbols:
      - OID: 1.3.6.1.4.1.13315.3.1.1.2.2.2.1.4
        name: bcnDhcpv4SubnetFreeAddresses
        description: The number of IPs addresses available in this subnet.
        family: DHCP/Subnets
        unit: "{ip_address}"
      - OID: 1.3.6.1.4.1.13315.3.1.1.2.2.2.1.3
        name: bcnDhcpv4SubnetSize
        description: Size of the subnet
        family: DHCP/Subnets
        unit: "{ip_address}"
    metric_tags:
      - symbol:
          OID: 1.3.6.1.4.1.13315.3.1.1.2.2.2.1.1
          name: bcnDhcpv4SubnetIP
        tag: bcn_dhcpv4_subnet_ip
      - symbol:
          OID: 1.3.6.1.4.1.13315.3.1.1.2.2.2.1.2
          name: bcnDhcpv4SubnetMask
        tag: bcn_dhcpv4_subnet_mask
  - MIB: BCN-DHCPV4-MIB
    table:
      OID: 1.3.6.1.4.1.13315.3.1.1.2.2.3
      name: bcnDhcpv4PoolTable
    symbols:
      - OID: 1.3.6.1.4.1.13315.3.1.1.2.2.3.1.5
        name: bcnDhcpv4PoolFreeAddresses
        description: The number of IPs addresses available in this pool
        family: DHCP/Pools
        unit: "{ip_address}"
      - OID: 1.3.6.1.4.1.13315.3.1.1.2.2.3.1.4
        name: bcnDhcpv4PoolSize
        description: Pool size
        family: DHCP/Pools
        unit: "{ip_address}"
    metric_tags:
      - symbol:
          OID: 1.3.6.1.4.1.13315.3.1.1.2.2.3.1.1
          name: bcnDhcpv4PoolStartIP
        tag: bcn_dhcpv4_pool_start_ip
      - symbol:
          OID: 1.3.6.1.4.1.13315.3.1.1.2.2.3.1.2
          name: bcnDhcpv4PoolEndIP
        tag: bcn_dhcpv4_pool_end_ip
      - symbol:
          OID: 1.3.6.1.4.1.13315.3.1.1.2.2.3.1.3
          name: bcnDhcpv4PoolSubnetIP
        tag: bcn_dhcpv4_pool_subnet_ip

metric_tags:
  - OID: 1.3.6.1.4.1.13315.3.2.2.1.1.0
    symbol: bcnSysIdProduct
    tag: bcn_sys_id_product
  - OID: 1.3.6.1.4.1.13315.3.2.2.1.2.0
    symbol: bcnSysIdOSRelease
    tag: bcn_sys_id_os_release
  - OID: 1.3.6.1.4.1.13315.3.2.2.1.5.0
    symbol: bcnSysIdPlatform
    tag: bcn_sys_id_platform
